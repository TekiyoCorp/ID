# üì± Tekiyo ID - R√©capitulatif Complet du Projet

## üéØ Vue d'ensemble

**Tekiyo ID** est une application iOS native d√©velopp√©e en SwiftUI pour la gestion d'identit√© d√©centralis√©e avec preuve d'humanit√© via Face ID et blockchain.

### Technologies utilis√©es
- **SwiftUI** - Framework UI d√©claratif
- **Combine** - Programmation r√©active
- **CoreMotion** - D√©tection de mouvement (gyroscope)
- **LocalAuthentication** - Face ID / Touch ID
- **AVFoundation** - Cam√©ra et capture photo
- **Vision** - D√©tection de visage en temps r√©el
- **CoreLocation** - G√©olocalisation
- **MapKit** - Recherche de lieux
- **CryptoKit** - Hachage SHA256 pour QR codes

---

## üìÅ Architecture du Projet

### Structure MVVM
```
Tekiyo ID/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Components/        # Composants r√©utilisables
‚îÇ   ‚îú‚îÄ‚îÄ Extensions/        # Extensions Swift
‚îÇ   ‚îú‚îÄ‚îÄ Managers/          # Singletons et services
‚îÇ   ‚îî‚îÄ‚îÄ Typography.swift   # Styles de texte globaux
‚îÇ
‚îú‚îÄ‚îÄ Features/
‚îÇ   ‚îú‚îÄ‚îÄ Onboarding/        # √âcrans de d√©marrage
‚îÇ   ‚îú‚îÄ‚îÄ Authentication/    # Face ID
‚îÇ   ‚îú‚îÄ‚îÄ Identity/          # Formulaire et capture photo
‚îÇ   ‚îú‚îÄ‚îÄ Messaging/         # Messages et chat
‚îÇ   ‚îú‚îÄ‚îÄ Wallet/            # Portefeuille et transactions
‚îÇ   ‚îî‚îÄ‚îÄ Profile/           # Profil utilisateur
‚îÇ
‚îî‚îÄ‚îÄ Assets.xcassets/       # Images et ic√¥nes
```

---

## üöÄ Flux d'onboarding

### 1. StartView
- √âcran de lancement avec logo Tekiyo
- Bouton "Commencer" pour d√©marrer

### 2. IntroductionView
- Explication du concept
- D√©tection du mouvement de l'iPhone (gyroscope)
- L'utilisateur doit incliner l'iPhone pour passer √† l'√©tape suivante
- **Debug**: Boutons skip disponibles en mode DEBUG

### 3. FaceIDSetupView
- Configuration de Face ID
- Demande de permission biom√©trique
- Animation et feedback haptique
- **Debug**: Boutons pour simuler succ√®s/skip

### 4. IdentitySetupView
- Formulaire d'identit√© en plusieurs √©tapes :
  - Nom
  - Pr√©nom
  - Date de naissance (DatePicker)
  - Nationalit√© (avec suggestions)
  - M√©tier
  - Ville (avec MapKit pour suggestions temps r√©el)
- Validation des champs √† chaque √©tape
- Navigation step-by-step

### 5. PhotoCaptureView
- Cam√©ra frontale en live
- Cercle bleu pointill√© (253px) pour cadrer le visage
- D√©tection de visage en temps r√©el avec Vision framework
- Validation : visage pr√©sent, centr√©, bien √©clair√©
- Indicateurs visuels : cercle vert si OK, rouge si KO
- Message d'aide en temps r√©el
- Boutons : "Importer depuis la galerie" et "Continuer"

### 6. FingerprintCreationView
- Animation de l'ic√¥ne SF Symbol `checkmark.seal.text.page.fill`
- D√©grad√© bleu (002FFF 100% ‚Üí 0%)
- Texte fixe : "Cr√©ation de ton empreinte.."
- Sous-titre : "Ton visage reste sur ton appareil..."
- Navigation automatique apr√®s 3-4 secondes

### 7. IdentityCompleteView
- Carte d'identit√© avec photo
- QR code circulaire (CircularCodeView)
- Tekiyo ID g√©n√©r√© (format: 3A1B-7E21)
- Username g√©n√©r√©
- Bouton "Afficher mon profil Tekiyo"

---

## üì± Application principale (Post-onboarding)

### Architecture TabBar (4 onglets)

#### üè† Home (house.fill)
- **PlaceholderTabView** "Accueil"
- En attente de d√©veloppement futur

#### üÜî Tekiyo ID (square.grid.3x3.fill)
- **ProfileView** - √âcran profil principal
- Header : avatar (43x43px) + bouton recherche
- Localisation temps r√©el : "‚òÄÔ∏è Paris"
- Greeting : "Bonjour Marie!"
- QR code circulaire (194x194px, dots 9x9px)
- Trust score : 10 barres (3 rouges actives, 27%)
- Derni√®re v√©rification
- Activit√©s r√©centes (overlay au tap)
- Section Liens : 12 r√©seaux sociaux en grille

#### üîî Notifications (bell.fill)
- **MessageListView** - Messages et notifications
- Segmented control natif (Messages / Notifications)
- Section "√âv√©nements" avec badge count (1)
- Liste de conversations :
  - Marie D. (online, unread)
  - Thomas S. (unread)
  - Julie F. (transaction 50‚Ç¨)
  - BNP (verified badge)
- Navigation vers **ChatView** au tap

#### üí∞ Wallet (wallet.pass.fill)
- **WalletView** - Portefeuille
- Balance totale : 12,754.84 ‚Ç¨
- Boutons actions : Envoyer, Recevoir, Ajouter
- Historique group√© par date :
  - Aujourd'hui
  - Hier
  - Dates sp√©cifiques (Jeudi 18/02)
- Transactions avec montants color√©s (+ vert, - blanc)

---

## üí¨ Syst√®me de Messaging

### MessageListView
- **Segmented Control** : Messages / Notifications (Picker natif)
- **Section √âv√©nements** avec badge (1)
- **ConversationRow** pour chaque conversation :
  - Avatar circulaire (56x56px)
  - Online indicator (point vert)
  - Nom + verified badge (si applicable)
  - Preview du dernier message
  - Timestamp
  - Unread dot (bleu)

### ChatView
- **Header** :
  - Bouton retour
  - Avatar contact (40x40px)
  - Nom + statut "En ligne"
- **Messages scrollables** :
  - MessageBubble pour textes
  - TransactionBubble pour paiements TekiyoPay
  - Avatar du contact √† gauche (32x32px)
  - Bulles user (droite, bleu) vs contact (gauche, gris)
- **Input field** :
  - Bouton + (plus.circle.fill)
  - TextField natif
  - Bouton send (arrow.up.circle.fill) ou mic (mic.fill)

### TransactionBubble
- Label "TekiyoPay"
- Montant 50‚Ç¨ en grand
- Avatar du sender

---

## üí≥ Syst√®me Wallet

### WalletView
- **Balance header** :
  - "Total"
  - Montant : 12,754.84 ‚Ç¨
  - Bouton expand
- **Action buttons** :
  - Envoyer (arrow.up.right)
  - Recevoir (arrow.down.left)
  - Ajouter (+)
- **Historique** :
  - Group√© par date (Aujourd'hui, Hier, dates)
  - TransactionRow pour chaque transaction :
    - Avatar (44x44px)
    - Nom + heure
    - Montant (+ vert / - blanc)

---

## üé® Design System

### Couleurs
- **Background principal** : `Color(hex: "111111")` (OLED black)
- **Texte primaire** : `.primary` (adaptatif dark/light)
- **Texte secondaire** : `.secondary`
- **Accents** :
  - Bleu : `Color.blue` (natif)
  - Vert : `Color.green` (success, cr√©dit)
  - Rouge : Pour trust score actif

### Typographie
- **Font syst√®me** : SF Pro Display
- **Styles natifs** :
  - `.headline` - Titres principaux
  - `.title2`, `.title3` - Sections
  - `.subheadline` - Sous-titres
  - `.body` - Corps de texte
  - `.caption` - M√©tadonn√©es
- **Custom tracking** : -6% (kerning) pour titres importants

### Composants UI
- **Frosted Glass** : `.ultraThinMaterial`
- **Corner radius** : `.continuous` style pour courbes Apple
- **Segmented Control** : Picker natif avec `.segmented`
- **TabBar** : Ic√¥nes seulement (sans texte)
- **Buttons** : `.plain` buttonStyle
- **Colors** : Syst√®me adaptatif (`.systemBackground`, `.systemGray6`)

---

## üîß Core Components

### LargeCircularCodeView
- QR code circulaire style App Clip
- 194x194px, dots 9x9px
- G√©n√©ration via SHA256 hash de l'URL
- ~100 dots en spirale
- Dot highlight au centre avec ring blanc
- Animation opacity + scale √† l'apparition
- URL : tekiyo.fr

### WalletWidget
- 342x291px, border radius 60px
- Frosted glass background
- Balance + 3 boutons actions
- Typographie SF Pro Display
- Padding 8px global

### CameraPreview
- AVCaptureVideoPreviewLayer
- Int√©gration SwiftUI via UIViewRepresentable
- Preview temps r√©el de la cam√©ra

### FaceDetectionOverlay
- Cercle pointill√© (253px)
- Couleur dynamique : vert (OK) / rouge (KO) / bleu (d√©faut)
- Message d'aide en temps r√©el
- Vision framework pour d√©tection

---

## üóÇÔ∏è Mod√®les de donn√©es

### IdentityData
```swift
struct IdentityData: Codable, Equatable {
    let nom: String
    let prenom: String
    let dateNaissance: Date
    let nationalite: String
    let metier: String
    let ville: String
}
```

### Message
```swift
struct Message: Identifiable, Equatable {
    let id: String
    let senderId: String
    let text: String
    let timestamp: Date
    let isFromCurrentUser: Bool
}
```

### Conversation
```swift
struct Conversation: Identifiable, Equatable {
    let id: String
    let user: ConversationUser
    let lastMessage: String
    let timestamp: Date
    let isUnread: Bool
}
```

### Transaction
```swift
struct Transaction: Identifiable, Equatable {
    let id: String
    let user: TransactionUser
    let amount: Double
    let type: TransactionType // credit / debit
    let timestamp: Date
}
```

---

## üéØ ViewModels

### IntroductionViewModel
- D√©tection gyroscope (CoreMotion)
- Gestion des √©tapes d'intro
- Feedback haptique

### FaceIDViewModel
- Gestion LocalAuthentication
- √âtats : idle, authenticating, success, failure
- Permission biom√©trique

### IdentityViewModel
- Validation formulaire step-by-step
- Gestion des √©tapes : nom, pr√©nom, date, nationalit√©, m√©tier, ville
- `isStepComplete()` pour chaque √©tape

### PhotoCaptureViewModel
- Gestion cam√©ra (CameraManager)
- Validation photo avec Vision
- √âtats : setup, ready, capturing, success, error

### MessageListViewModel
- Segmented control (Messages / Notifications)
- Liste conversations avec donn√©es mock
- Badge √©v√©nements

### ChatViewModel
- Gestion messages
- Envoi de messages
- Support TransactionBubble

### WalletViewModel
- Balance
- Transactions group√©es par date
- Actions : send, receive, add

### ProfileViewModel
- Localisation temps r√©el (LocationManager)
- Permission g√©olocalisation
- Ville de l'utilisateur

---

## üîê Managers & Services

### HapticManager (Singleton)
- `success()`, `error()`, `warning()`
- `impact(style:)` - light, medium, heavy
- `selection()`
- Feedback haptique unifi√©

### BiometricAuthManager (Singleton)
- `authenticateUser()` async
- Gestion Face ID / Touch ID
- Messages d'erreur localis√©s

### CameraManager
- Configuration AVCaptureSession
- Photo capture
- Preview layer
- Gestion permissions

### LocationManager
- CLLocationManager
- Demande permission
- G√©ocodage reverse (coordonn√©es ‚Üí ville)
- Publication ville via @Published

### RealtimeFaceDetector
- AVCaptureVideoDataOutput
- VNDetectFaceRectanglesRequest
- D√©tection temps r√©el
- Thread-safe avec NSLock

---

## üõ†Ô∏è Extensions

### Color+Hex
```swift
init(hex: String)
// Support: RGB (12-bit), RGB (24-bit), ARGB (32-bit)
```

### View+DebugRender
```swift
func debugRenders(_ label: String) -> some View
// Logging des re-renders en DEBUG
```

### AppTypography
```swift
func appTypography(fontSize: CGFloat) -> some View
// Tracking -6%, lineSpacing ajust√©
```

---

## üîÑ Navigation Flow

### Onboarding complet
```
StartView
  ‚Üí IntroductionView (gyroscope)
    ‚Üí FaceIDSetupView
      ‚Üí IdentitySetupView (formulaire multi-step)
        ‚Üí PhotoCaptureView
          ‚Üí FingerprintCreationView (animation 3-4s)
            ‚Üí IdentityCompleteView
              ‚Üí ProfileTabContainerView
```

### Navigation dans l'app
- **TabView** avec 4 onglets
- **MessageListView ‚Üí ChatView** : NavigationLink
- **ProfileView ‚Üí ActivitiesOverlay** : Sheet overlay
- **TransactionBubble ‚Üí WalletView** : Changement de tab (futur)

---

## üìä √âtats et gestion

### @Published states
- `@Published var isLoading: Bool`
- `@Published var errorMessage: String?`
- `@Published var currentStep: Step`
- `@Published var selectedSegment: Segment`

### @StateObject ViewModels
- ViewModels inject√©s via `@StateObject`
- Singleton Managers via `.shared`

### Combine pipelines
- R√©activit√© avec `@Published`
- Observers dans Views via `@StateObject`

---

## üé® Optimisations

### Performance
- `.drawingGroup()` pour vues complexes
- LazyVStack/LazyVGrid pour listes
- √âviter re-renders inutiles (@State stable)
- `.animation(.easeOut, value:)` cibl√©e

### √ânergie
- Limitation reactive updates
- Stable `@Binding` et `@State`
- Pas d'animations infinies par d√©faut
- `.debugRenders()` pour monitoring

---

## üß™ Mode DEBUG

### Bypass pour d√©veloppement Mac
- **IntroductionView** : Boutons skip steps / FaceID
- **FaceIDSetupView** : Boutons simuler succ√®s / passer
- Point d'entr√©e direct sur **ProfileTabContainerView** avec donn√©es mock

### Configuration DEBUG
```swift
#if DEBUG
ProfileTabContainerView(
    identityData: IdentityData(
        nom: "Dupont",
        prenom: "Marie",
        dateNaissance: Date(),
        nationalite: "Fran√ßaise",
        metier: "Directrice artistique",
        ville: "Paris"
    ),
    profileImage: nil,
    tekiyoID: "3A1B-7E21",
    username: "@marieD77"
)
#endif
```

---

## üì± Donn√©es Mock

### Profil
- **Nom** : Marie Dupont
- **Username** : @marieD77
- **M√©tier** : Directrice artistique
- **Ville** : Paris
- **Tekiyo ID** : 3A1B-7E21
- **Trust Score** : 27% (3/10)

### Conversations
1. **Marie D.** - En ligne, non lu, "Salut, tu peux..."
2. **Thomas S.** - Non lu, "Merci pour aujourd'hui"
3. **Julie F.** - "Vous a envoy√© 50‚Ç¨"
4. **BNP** - V√©rifi√©, "Vous a envoy√© un document"

### Messages (chat Marie D.)
- Transaction TekiyoPay : 50‚Ç¨
- User : "Putin merci beaucoup !"
- Marie : "Avec plaisir c'√©tait top"
- User : "Grave !"

### Transactions Wallet
- **Aujourd'hui** :
  - Marie D. +23‚Ç¨ 17:03
  - Thomas L. -74‚Ç¨ 12:08
- **Hier** :
  - Marie D. +23‚Ç¨ 17:03
  - Thomas L. -74‚Ç¨ 12:08
- **Jeudi 18/02** :
  - Marie D. +23‚Ç¨ 17:03

### Liens sociaux
Facebook, Twitter, Instagram, Snapchat, LinkedIn, GitHub, TikTok, Discord, Telegram, Gmail, WhatsApp, YouTube

---

## üîê Permissions requises

### Info.plist
- `NSCameraUsageDescription` : "Pour prendre votre photo d'identit√©"
- `NSFaceIDUsageDescription` : "Pour s√©curiser votre identit√©"
- `NSLocationWhenInUseUsageDescription` : "Pour afficher votre ville"
- `NSPhotoLibraryUsageDescription` : "Pour importer une photo"

---

## üéØ Principes de d√©veloppement appliqu√©s

### Architecture
- ‚úÖ **MVVM strict** - S√©paration Views / ViewModels / Models
- ‚úÖ **Single Responsibility** - 1 fichier = 1 responsabilit√©
- ‚úÖ **Modularit√©** - Composants r√©utilisables
- ‚úÖ **Injection de d√©pendances** - ViewModels testables
- ‚úÖ **Fichiers courts** - Max 500 lignes, id√©alement < 400

### Code Quality
- ‚úÖ **Nommage descriptif** - Pas de noms vagues (data, info, helper)
- ‚úÖ **Fonctions courtes** - < 30-40 lignes
- ‚úÖ **Classes cibl√©es** - Pas de God classes
- ‚úÖ **Commentaires utiles** - MARK pour sections
- ‚úÖ **SwiftUI natif** - Composants syst√®me iOS

### Performance
- ‚úÖ **Lazy loading** - LazyVStack/LazyVGrid
- ‚úÖ **Optimisations GPU** - .drawingGroup()
- ‚úÖ **Animations cibl√©es** - .animation(value:)
- ‚úÖ **√âtats stables** - √âviter re-renders inutiles

---

## üì¶ Fichiers cl√©s du projet

### Core
- `Tekiyo_IDApp.swift` - Point d'entr√©e
- `Typography.swift` - Styles texte
- `Color+Hex.swift` - Extension couleurs hex
- `View+DebugRender.swift` - Debug renders

### Managers
- `HapticManager.swift` - Feedback haptique
- `BiometricAuthManager.swift` - Face ID
- `CameraManager.swift` - Cam√©ra
- `LocationManager.swift` - G√©olocalisation
- `RealtimeFaceDetector.swift` - D√©tection visage

### Components
- `LargeCircularCodeView.swift` - QR circulaire
- `WalletWidget.swift` - Widget portefeuille
- `CameraPreview.swift` - Preview cam√©ra
- `FaceDetectionOverlay.swift` - Overlay d√©tection
- `PrimaryButton.swift` - Bouton principal

### Features
- **Onboarding** : StartView, IntroductionView
- **Auth** : FaceIDSetupView
- **Identity** : IdentitySetupView, PhotoCaptureView, FingerprintCreationView, IdentityCompleteView
- **Messaging** : MessageListView, ChatView, ConversationRow, MessageBubble, TransactionBubble
- **Wallet** : WalletView, TransactionRow, WalletActionButtons
- **Profile** : ProfileView, ProfileTabContainerView, RecentActivitiesView

---

## üöÄ √âtat actuel du projet

### ‚úÖ Fonctionnalit√©s compl√®tes
- Onboarding complet (intro, FaceID, formulaire, photo)
- D√©tection de visage temps r√©el avec Vision
- Syst√®me de messaging natif avec chat
- Portefeuille avec transactions group√©es
- Profil utilisateur avec QR code circulaire
- TabBar 4 onglets (ic√¥nes seulement)
- G√©olocalisation temps r√©el
- Dark mode par d√©faut
- Architecture MVVM compl√®te
- Composants 100% SwiftUI natifs

### üîÑ En attente
- √âcran Home (placeholder actuel)
- Backend / API int√©gration
- Blockchain pour empreinte digitale
- V√©rification d'identit√© r√©elle
- Notifications push
- Partage de profil

### üêõ Debug features
- Skip intro/FaceID sur Mac
- D√©marrage direct sur profil en DEBUG
- Donn√©es mock pour tous les √©crans
- Logging des renders

---

## üìà Statistiques

- **Langage** : Swift 5.9+, SwiftUI
- **Minimum iOS** : iOS 16.0+
- **Architecture** : MVVM
- **Fichiers** : ~50+ fichiers Swift
- **Composants** : 30+ composants r√©utilisables
- **ViewModels** : 10+ ViewModels
- **Managers** : 5 Singletons
- **√âcrans** : 15+ vues principales
- **Mod√®les** : 10+ structures de donn√©es

---

## üéì Bonnes pratiques appliqu√©es

1. **Pas de d√©pendances externes** - SwiftUI/UIKit natif uniquement
2. **Support Dark/Light mode** - Couleurs syst√®me adaptatives
3. **Accessibilit√©** - Dynamic Type, VoiceOver ready
4. **Performances** - Optimisations GPU, lazy loading
5. **S√©curit√©** - Face ID, donn√©es locales
6. **Tests** - Architecture testable (injection d√©pendances)
7. **Scalabilit√©** - Modulaire, extensible
8. **Maintenance** - Code propre, bien document√©

---

## üîÆ Prochaines √©tapes sugg√©r√©es

1. **Backend integration** - API REST ou GraphQL
2. **Blockchain** - Stockage empreinte d√©centralis√©e
3. **Notifications** - Push notifications
4. **Partage** - QR code scan, NFC
5. **Analytics** - Tracking usage
6. **Tests** - Unit tests, UI tests
7. **CI/CD** - Automatisation d√©ploiement
8. **App Clip** - Version l√©g√®re pour v√©rification rapide

---

## üìù Notes importantes

- **Mode DEBUG activ√©** : App d√©marre sur profil avec donn√©es mock
- **Permissions requises** : Cam√©ra, Face ID, Localisation, Photos
- **SwiftUI natif** : Aucune lib tierce, 100% composants syst√®me
- **MVVM strict** : S√©paration claire Models/Views/ViewModels
- **Optimis√© √©nergie** : Animations cibl√©es, pas de loops infinies
- **Design Apple-like** : Frosted glass, continuous corners, SF Symbols

---

*Projet Tekiyo ID - Identity & Proof of Humanity*
*D√©velopp√© avec SwiftUI, MVVM Architecture, 100% Native iOS*

